
@{
    ViewBag.Title = "History";
}

<div style="background-color:lightgrey">
    <div class="mx-auto" style="max-width: 600px;">
        <div class="text-center" style="font-size:2rem; color:#555; font-weight:600; font-family:sans-serif;">
            <img src="~/Images/TimeLogo.png" alt="Ambulance" style="width:100px; height:100px" />
            <br />
            Ride History
        </div>
    </div>
    <br />
    <div id="historyContainer"></div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
    var historyContainer = document.getElementById('historyContainer');
    var bookings = JSON.parse(localStorage.getItem('bookings'));
    if (!bookings.length) {
        historyContainer.innerHTML = '<div class="text-center" style="color:#888;">No bookings found.</div>';
        return;
    }

    // Optionally, reverse to show most recent first
    bookings.slice().reverse().forEach(function (booking) {
        // Format date
        var dateStr = booking.bookingDate
            ? new Date(booking.bookingDate).toLocaleDateString()
            : '';

        // SOS example: if you have a flag like booking.sos === true
        var isSOS = booking.sos === true;
        var borderColor = isSOS ? 'red' : '#ddd';
        var titleColor = isSOS ? 'red' : '#555';
        var titleText = isSOS ? dateStr + ' - S.O.S.' : dateStr;

        // Build card HTML
        var card = `
<div class="d-flex justify-content-center">
    <div class="card booking-card" style="width:700px; border-color:${borderColor}; cursor:pointer;" 
         onclick="viewConfirmedBooking('${booking.bookingId}')">
        <div class="card-body">
            <div class="row" style="font-size:2rem; color:${titleColor}; font-weight:600; font-family:sans-serif;">
                ${titleText}
            </div>
            <br />
            <div class="row">
                <div class="col">
                    Booking ID: ${booking.bookingId || ''} <br />
                    Driver Name: ${booking.driver || ''} <br/>
                    Ambulance Type: ${booking.vehicle || ''} <br />
                    Pick-Up Address: ${booking.address || ''} <br />
                </div>
            </div>
        </div>
    </div>
</div>
<br />
`;
        historyContainer.innerHTML += card;
    });
});

    function viewConfirmedBooking(bookingId) {
        // Store the selected bookingId in localStorage
        localStorage.setItem('selectedBookingId', bookingId);
        // Redirect to the Confirmed view
        window.location.href = '/Home/Confirmed';
    }
    </script>


